{% assign productMetafields = product.metafields.product %}
{% assign theCollection = blank %}

{% for coll in product.collections %}
  {% capture theCollection %}***{{ coll.handle }}***,{{ theCollection }}{% endcapture %}
{% endfor %}

<script type="application/javascript">
  window.productMediaInfo = {
    "title": {% if section.settings.title %}"{{ section.settings.title }}"{% else %}false{% endif %},
    "description": {% if section.settings.description %}`{{ section.settings.description }}`{% else %}false{% endif %}
  };

  window.productMedia = {
    {% for block in section.blocks limit: section.blocks.size %}
      {% capture formatedCollection %}***{{ block.settings.collection  }}***,{% endcapture %}
      {% if theCollection contains formatedCollection %}
        '{{ block.settings.collection }}': {
          'video': '{{ block.settings.embed_video_id }}',
          'images': [
            {% if block.settings.image_1 %}"{{ block.settings.image_1 | img_url: 'master' }}",{% endif %}
            {% if block.settings.image_2 %}"{{ block.settings.image_2 | img_url: 'master' }}",{% endif %}
            {% if block.settings.image_3 %}"{{ block.settings.image_3 | img_url: 'master' }}",{% endif %}
            {% if block.settings.image_4 %}"{{ block.settings.image_4 | img_url: 'master' }}",{% endif %}
            {% if block.settings.image_5 %}"{{ block.settings.image_5 | img_url: 'master' }}",{% endif %}
            {% if block.settings.image_6 %}"{{ block.settings.image_6 | img_url: 'master' }}",{% endif %}
            {% if block.settings.image_7 %}"{{ block.settings.image_7 | img_url: 'master' }}",{% endif %}
            {% if block.settings.image_8 %}"{{ block.settings.image_8 | img_url: 'master' }}",{% endif %}
            {% if block.settings.image_8 %}"{{ block.settings.image_8 | img_url: 'master' }}",{% endif %}
            {% if block.settings.image_10 %}"{{ block.settings.image_10 | img_url: 'master' }}"{% endif %}
          ]
        },
      {% endif %}
    {% endfor %}
  };
</script>

{% schema %}
{
  "name": "Product Media",
  "settings": [
    {
      "type": "header",
      "content": "Product Media Section"
    },
    {
      "type": "text",
      "id": "title",
      "label": "Product Media Title"
    },
    {
      "type": "richtext",
      "id": "description",
      "label": "Product Media Description"
    }
  ],
  "blocks": [
    {
      "type": "product_media",
      "name": "Media Slider Image",
      "settings": [
        {
          "type": "collection",
          "id": "collection",
          "label": "Pick a Collection"
        },
        {
          "type": "text",
          "id": "embed_video_id",
          "label": "Embed Video ID"
        },
        {
          "type": "header",
          "content": "Image 1"
        },
        {
          "type": "image_picker",
          "id": "image_1",
          "label": "Pick an image."
        },
        {
          "type": "header",
          "content": "Image 2"
        },
        {
          "type": "image_picker",
          "id": "image_2",
          "label": "Pick an image."
        },
        {
          "type": "header",
          "content": "Image 3"
        },
        {
          "type": "image_picker",
          "id": "image_3",
          "label": "Pick an image."
        },
        {
          "type": "header",
          "content": "Image 4"
        },
        {
          "type": "image_picker",
          "id": "image_4",
          "label": "Pick an image."
        },
        {
          "type": "header",
          "content": "Image 5"
        },
        {
          "type": "image_picker",
          "id": "image_5",
          "label": "Pick an image."
        },
        {
          "type": "header",
          "content": "Image 6"
        },
        {
          "type": "image_picker",
          "id": "image_6",
          "label": "Pick an image."
        },
        {
          "type": "header",
          "content": "Image 7"
        },
        {
          "type": "image_picker",
          "id": "image_7",
          "label": "Pick an image."
        },
        {
          "type": "header",
          "content": "Image 8"
        },
        {
          "type": "image_picker",
          "id": "image_8",
          "label": "Pick an image."
        },
        {
          "type": "header",
          "content": "Image 9"
        },
        {
          "type": "image_picker",
          "id": "image_9",
          "label": "Pick an image."
        },
        {
          "type": "header",
          "content": "Image 10"
        },
        {
          "type": "image_picker",
          "id": "image_10",
          "label": "Pick an image."
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Product Media",
      "category": "Layout"
    }
  ]
}
{% endschema %}
