$('.js-on-click').on('click', function() {
  var target = $(this).data('onclick-target');
  var targetClass = $(this).data('onclick-class');

  $(target).toggleClass(targetClass);
});

$(window).scroll(function(){
  $('.js-on-show').each(function() {
    var target = $(this).data('onshow-target');
    var targetClass = $(this).data('onshow-class');
    if (isScrolledIntoView($(this))) {
      $(this).find(target).addClass(targetClass || 'animate');
    }
  });
});

function isScrolledIntoView(elem){
  var $elem = $(elem);
  var $window = $(window);

  var docViewTop = $window.scrollTop();
  var docViewBottom = docViewTop + $window.height();

  var elemTop = $elem.offset().top;
  var elemBottom = elemTop + $elem.height();

  return ((elemBottom <= docViewBottom) && (elemTop >= docViewTop));
}

var siteHeaderHeight = $('[data-section-id="header"]').height() + 20;
var productDetailsHeight = $('.product-header__details').height();
var imagesOffset = $('.product-header__images').height();
var imagesOffsetFinal = (imagesOffset - window.innerHeight) + siteHeaderHeight;
var bottomSize = window.innerHeight - (siteHeaderHeight + productDetailsHeight);
var productToolbarOffset = $('.product-toolbar').height();
var pageScrollClass = 'images-viewed';
var productToolbarBodyClass = 'product-toolbar--visible';
var productPageClass = 'page--product';

function manageDetailsPosition() {
  var scrollTop = $(window).scrollTop();

  if (scrollTop >= (imagesOffsetFinal + bottomSize)) {
    $('body').addClass(pageScrollClass);
  } else if (scrollTop < (imagesOffsetFinal + bottomSize)) {
    $('body').removeClass(pageScrollClass);
  }

  if (scrollTop >= (imagesOffset - productToolbarOffset)) {
    $('body').addClass(productToolbarBodyClass);
  } else {
    $('body').removeClass(productToolbarBodyClass);
  }
}

function initializeEffect() {
  if (imagesOffsetFinal > 0) {
    if ($(window).scrollTop() >= (imagesOffsetFinal + bottomSize)) {
      $('body').addClass(pageScrollClass);
    }
  } else {
    setTimeout(function() {
      initializeEffect();
    }, 1000);
  }
}

if ($('body').hasClass(productPageClass)) {
  initializeEffect();


  $(window).scroll(function() {
    manageDetailsPosition();
  });
}

window.template = (function() {
  var classes = {
    domReady: 'dom-ready',
  };

  function domReady() {
    $('html').addClass(classes.domReady);
  }

  function init() {
    domReady();
  }

  return {
    init: init,
  };
})();
